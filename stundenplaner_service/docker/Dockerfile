FROM maven:3.8-amazoncorretto-16 as build

ARG MVN_SETTINGS_OPTION

WORKDIR /usr/local/app
COPY . /usr/local/app/

RUN mvn ${MVN_SETTINGS_OPTION} clean install -P prod -DskipTests


FROM amazoncorretto:16
#todo: JVM Optimization needed?

COPY --from=build /usr/local/app/target/timetable-*.jar app.jar
ENTRYPOINT ["java","-jar","/app.jar"]